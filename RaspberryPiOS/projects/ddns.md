# Dynamic DNS Client

En esta sección se explica cómo configurar un cliente de DNS dinámico para que nuestra Raspberry Pi pueda ser accesible desde cualquier lugar de Internet.

## ¿Qué es un DNS dinámico?

Un DNS dinámico es un servicio que nos permite asignar un nombre de dominio a una dirección IP dinámica. Esto es muy útil para poder acceder a nuestra Raspberry Pi desde cualquier lugar de Internet, ya que la mayoría de proveedores de Internet asignan direcciones IP dinámicas a sus clientes, es decir, que cada vez que se reinicia el router, la dirección IP cambia.

## ¿Cómo funciona?

El funcionamiento es muy sencillo. El cliente de DNS dinámico se ejecuta en nuestra Raspberry Pi y se encarga de comprobar cada cierto tiempo si la dirección IP ha cambiado. Si es así, se conecta al servidor de DNS dinámico y actualiza la dirección IP asociada al nombre de dominio que hayamos elegido.

## ¿Qué necesitamos?

Para poder configurar un cliente de DNS dinámico necesitamos:

- Una Raspberry Pi con una dirección IP pública.
- Un nombre de dominio.
- Un cliente de DNS dinámico.

## ¿Cómo lo hacemos?

### 1. Configurar el router

Lo primero que tenemos que hacer es configurar el router para que redirija el tráfico de los puertos 80 y 443 a nuestra Raspberry Pi. Esto es necesario para que el servidor web pueda recibir peticiones desde Internet.

### 2. Instalamos el cliente de DNS dinámico

En mi caso, he elegido el cliente de DNS dinámico `ddclient`. Para instalarlo, ejecutamos el siguiente comando:

```bash
sudo apt update
sudo apt upgrade -y
sudo apt install libio-socket-ssl-perl
sudo apt install ddclient
```

### 3. Configuramos el cliente de DNS dinámico

Una vez instalado, tenemos que configurar el cliente de DNS dinámico. Para ello, editamos el archivo `/etc/ddclient.conf`:

```bash
sudo nano /etc/ddclient.conf
```

Y lo dejamos de la siguiente manera:

```bash
# /etc/ddclient.conf

# Configuration file for ddclient generated by debconf
#
# /etc/ddclient.conf

protocol=dyndns2
use=web, web=checkip.dyndns.com/, web-skip='IP Address'
server=members.dyndns.org
login=yourlogin
password='yourpassword'
yourdomain.com
```

Donde:

- `yourlogin` es el nombre de usuario que hemos elegido para acceder al servicio de DNS dinámico.
- `yourpassword` es la contraseña que hemos elegido para acceder al servicio de DNS dinámico.
- `yourdomain.com` es el nombre de dominio que hemos elegido para nuestra Raspberry Pi.

### 4. Reiniciamos el servicio

Una vez configurado, reiniciamos el servicio:

```bash
sudo systemctl restart ddclient
```

### 5. Comprobamos que funciona

Para comprobar que funciona, podemos ejecutar el siguiente comando:

```bash
sudo ddclient -daemon=0 -debug -verbose -noquiet
```

Si todo ha ido bien, deberíamos ver algo como esto:

```bash
CONNECT:  members.dyndns.org
SEND:    GET /nic/update?system=dyndns&hostname=yourdomain.com&myip=yourip HTTP/1.0
SEND:    Host: members.dyndns.org
SEND:    Authorization: Basic base64encodedloginpassword==
SEND:    User-Agent: ddclient/3.8.3
SEND:
RECEIVE: HTTP/1.1 200 OK
RECEIVE: Server: DynDNS-CheckIP/1.0.1
RECEIVE: Cache-Control: no-cache
RECEIVE: Connection: close
RECEIVE: Pragma: no-cache
RECEIVE: Content-Type: text/html
RECEIVE: Expires: Thu, 01 Dec 1994 16:00:00 GMT
RECEIVE: Last-modified: Thu, 01 Dec 1994 16:00:00 GMT
RECEIVE:
RECEIVE: good
SUCCESS:  updating yourdomain.com: good: IP address set to yourip
```

### 6. Configuramos el servicio para que se ejecute en segundo plano

Para que el servicio se ejecute en segundo plano, utilizaremos el siguiente comando:

```bash
sudo systemctl enable ddclient
sudo update-rc.d ddclient defaults
```

A partir de ahora el servicio se ejecutará automáticamente cada 5 minutos.

